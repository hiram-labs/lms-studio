---
import BaseLayout from './BaseLayout.astro';

import { generateDashboardBreadcrumbs } from '../libs/utils'

const { title } = Astro.props;

const breadcrumbs = generateDashboardBreadcrumbs(Astro.url)
---

<BaseLayout title={title} description="" ogImage="">
<div class="flex h-screen">

    <nav class="w-64 bg-base-200 overflow-y-auto" aria-label="Main Navigation">
        <div class="sticky top-0 bg-base-300 px-6 py-4 z-50">
            <img src="/images/logo.png" alt="Logo" class="h-12 w-auto" />
        </div>

        <div class="py-4">
            <ul class="menu p-2">
                <li class="menu-item mb-2">
                    <a href="/dashboard/profile" class="nav-link" aria-haspopup="true" aria-controls="profile-dropdown" aria-expanded="false">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5">
                            <path fill-rule="evenodd" d="M1 6a3 3 0 0 1 3-3h12a3 3 0 0 1 3 3v8a3 3 0 0 1-3 3H4a3 3 0 0 1-3-3V6Zm4 1.5a2 2 0 1 1 4 0 2 2 0 0 1-4 0Zm2 3a4 4 0 0 0-3.665 2.395.75.75 0 0 0 .416 1A8.98 8.98 0 0 0 7 14.5a8.98 8.98 0 0 0 3.249-.604.75.75 0 0 0 .416-1.001A4.001 4.001 0 0 0 7 10.5Zm5-3.75a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5h-2.5a.75.75 0 0 1-.75-.75Zm0 6.5a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5h-2.5a.75.75 0 0 1-.75-.75Zm.75-4a.75.75 0 0 0 0 1.5h2.5a.75.75 0 0 0 0-1.5h-2.5Z" clip-rule="evenodd" />
                        </svg>
                        <span class="ml-3">
                            Profile
                        </span>
                    </a>
                    <ul id="profile-dropdown" class="submenu pl-4 hidden">
                        <!-- <a href="#section1" class="block px-3 py-1 my-2 rounded hover:bg-gray-300">Submenu 1</a> -->
                    </ul>
                </li>
                <li class="menu-item mb-2">
                    <a href="/dashboard/users" class="nav-link" aria-haspopup="true" aria-controls="users-dropdown" aria-expanded="false">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5">
                            <path d="M7 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6ZM14.5 9a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5ZM1.615 16.428a1.224 1.224 0 0 1-.569-1.175 6.002 6.002 0 0 1 11.908 0c.058.467-.172.92-.57 1.174A9.953 9.953 0 0 1 7 18a9.953 9.953 0 0 1-5.385-1.572ZM14.5 16h-.106c.07-.297.088-.611.048-.933a7.47 7.47 0 0 0-1.588-3.755 4.502 4.502 0 0 1 5.874 2.636.818.818 0 0 1-.36.98A7.465 7.465 0 0 1 14.5 16Z" />
                        </svg>
                        <span class="ml-3">
                            Users
                        </span>
                    </a>
                    <ul id="users-dropdown" class="submenu pl-4 hidden">
                        <!-- <a href="#section1" class="block px-3 py-1 my-2 rounded hover:bg-gray-300">Submenu 1</a> -->
                    </ul>
                </li>
                <li class="menu-item mb-2">
                    <a href="/dashboard/groups" class="nav-link" aria-haspopup="true" aria-controls="groups-dropdown" aria-expanded="false">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5">
                            <path d="M10 9a3 3 0 1 0 0-6 3 3 0 0 0 0 6ZM6 8a2 2 0 1 1-4 0 2 2 0 0 1 4 0ZM1.49 15.326a.78.78 0 0 1-.358-.442 3 3 0 0 1 4.308-3.516 6.484 6.484 0 0 0-1.905 3.959c-.023.222-.014.442.025.654a4.97 4.97 0 0 1-2.07-.655ZM16.44 15.98a4.97 4.97 0 0 0 2.07-.654.78.78 0 0 0 .357-.442 3 3 0 0 0-4.308-3.517 6.484 6.484 0 0 1 1.907 3.96 2.32 2.32 0 0 1-.026.654ZM18 8a2 2 0 1 1-4 0 2 2 0 0 1 4 0ZM5.304 16.19a.844.844 0 0 1-.277-.71 5 5 0 0 1 9.947 0 .843.843 0 0 1-.277.71A6.975 6.975 0 0 1 10 18a6.974 6.974 0 0 1-4.696-1.81Z" />
                        </svg>
                        <span class="ml-3">
                            Groups
                        </span>
                    </a>
                    <ul id="groups-dropdown" class="submenu pl-4 hidden">
                        <!-- <a href="#section1" class="block px-3 py-1 my-2 rounded hover:bg-gray-300">Submenu 1</a> -->
                    </ul>
                </li>
                <li class="menu-item mb-2">
                    <a href="/dashboard/content" class="nav-link" aria-haspopup="true" aria-controls="content-dropdown" aria-expanded="false">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5">
                            <path fill-rule="evenodd" d="M2.5 3A1.5 1.5 0 0 0 1 4.5v4A1.5 1.5 0 0 0 2.5 10h6A1.5 1.5 0 0 0 10 8.5v-4A1.5 1.5 0 0 0 8.5 3h-6Zm11 2A1.5 1.5 0 0 0 12 6.5v7a1.5 1.5 0 0 0 1.5 1.5h4a1.5 1.5 0 0 0 1.5-1.5v-7A1.5 1.5 0 0 0 17.5 5h-4Zm-10 7A1.5 1.5 0 0 0 2 13.5v2A1.5 1.5 0 0 0 3.5 17h6a1.5 1.5 0 0 0 1.5-1.5v-2A1.5 1.5 0 0 0 9.5 12h-6Z" clip-rule="evenodd" />
                        </svg>
                        <span class="ml-3">
                            Content
                        </span>
                    </a>
                    <ul id="content-dropdown" class="submenu pl-4 hidden">
                        <!-- <a href="#section1" class="block px-3 py-1 my-2 rounded hover:bg-gray-300">Submenu 1</a> -->
                    </ul>
                </li>
                <li class="menu-item mb-2">
                    <a href="/dashboard/bundles" class="nav-link" aria-haspopup="true" aria-controls="bundles-dropdown" aria-expanded="false">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5">
                            <path d="m3.196 12.87-.825.483a.75.75 0 0 0 0 1.294l7.25 4.25a.75.75 0 0 0 .758 0l7.25-4.25a.75.75 0 0 0 0-1.294l-.825-.484-5.666 3.322a2.25 2.25 0 0 1-2.276 0L3.196 12.87Z" />
                            <path d="m3.196 8.87-.825.483a.75.75 0 0 0 0 1.294l7.25 4.25a.75.75 0 0 0 .758 0l7.25-4.25a.75.75 0 0 0 0-1.294l-.825-.484-5.666 3.322a2.25 2.25 0 0 1-2.276 0L3.196 8.87Z" />
                            <path d="M10.38 1.103a.75.75 0 0 0-.76 0l-7.25 4.25a.75.75 0 0 0 0 1.294l7.25 4.25a.75.75 0 0 0 .76 0l7.25-4.25a.75.75 0 0 0 0-1.294l-7.25-4.25Z" />
                        </svg>
                        <span class="ml-3">
                            Bundles
                        </span>
                    </a>
                    <ul id="bundles-dropdown" class="submenu pl-4 hidden">
                        <!-- <a href="#section1" class="block px-3 py-1 my-2 rounded hover:bg-gray-300">Submenu 1</a> -->
                    </ul>
                </li>
                <li class="menu-item mb-2">
                    <a href="/dashboard/subscriptions" class="nav-link" aria-haspopup="true" aria-controls="subscriptions-dropdown" aria-expanded="false">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5">
                            <path fill-rule="evenodd" d="M15.75 3A2.25 2.25 0 0 1 18 5.25v1.214c0 .423-.277.788-.633 1.019A2.997 2.997 0 0 0 16 10c0 1.055.544 1.982 1.367 2.517.356.231.633.596.633 1.02v1.213A2.25 2.25 0 0 1 15.75 17H4.25A2.25 2.25 0 0 1 2 14.75v-1.213c0-.424.277-.789.633-1.02A2.998 2.998 0 0 0 4 10a2.997 2.997 0 0 0-1.367-2.517C2.277 7.252 2 6.887 2 6.463V5.25A2.25 2.25 0 0 1 4.25 3h11.5ZM13.5 7.396a.75.75 0 0 0-1.5 0v1.042a.75.75 0 0 0 1.5 0V7.396Zm0 4.167a.75.75 0 0 0-1.5 0v1.041a.75.75 0 0 0 1.5 0v-1.041Z" clip-rule="evenodd" />
                        </svg>
                        <span class="ml-3">
                            Subscription
                        </span>
                    </a>
                    <ul id="subscriptions-dropdown" class="submenu pl-4 hidden">
                        <!-- <a href="#section1" class="block px-3 py-1 my-2 rounded hover:bg-gray-300">Submenu 1</a> -->
                    </ul>
                </li>
                <li class="menu-item mb-2">
                    <a href="/dashboard/audit-logs" class="nav-link" aria-haspopup="true" aria-controls="audit-logs-dropdown" aria-expanded="false">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5">
                            <path fill-rule="evenodd" d="M4.5 2A1.5 1.5 0 0 0 3 3.5v13A1.5 1.5 0 0 0 4.5 18h11a1.5 1.5 0 0 0 1.5-1.5V7.621a1.5 1.5 0 0 0-.44-1.06l-4.12-4.122A1.5 1.5 0 0 0 11.378 2H4.5Zm2.25 8.5a.75.75 0 0 0 0 1.5h6.5a.75.75 0 0 0 0-1.5h-6.5Zm0 3a.75.75 0 0 0 0 1.5h6.5a.75.75 0 0 0 0-1.5h-6.5Z" clip-rule="evenodd" />
                        </svg>
                        <span class="ml-3">
                            Audit Logs
                        </span>
                    </a>
                    <ul id="audit-logs-dropdown" class="submenu pl-4 hidden">
                        <!-- <a href="#section1" class="block px-3 py-1 my-2 rounded hover:bg-gray-300">Submenu 1</a> -->
                    </ul>
                </li>
            </ul>
        </div>
    </nav>

    <main class="flex-1 overflow-y-auto" role="main">
        <div class="sticky top-0 px-6 pt-2 pb-1 bg-base-300 z-50">
            <div class="flex justify-between items-center w-full">
                <div class="breadcrumbs text-sm">
                    <ul class="bg-base-200 rounded-box px-5 py-4">
                        {breadcrumbs.map(item => (
                            <li><a href={item.url}>{item.name}</a></li>
                        ))}
                    </ul>
                </div>

                <div>
                    <ul class="menu menu-horizontal bg-base-200 rounded-box">
                        <li>
                            <a href="#" class="tooltip tooltip-bottom" data-tip="notifications">
                                <div class="indicator">
                                    <span class="indicator-item badge badge-xs badge-secondary"></span>
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0" />
                                    </svg>
                                </div>
                            </a>
                        </li>
                        <li>
                          <a href="/login/pin" class="tooltip tooltip-bottom" data-tip="logout">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 9V5.25A2.25 2.25 0 0 1 10.5 3h6a2.25 2.25 0 0 1 2.25 2.25v13.5A2.25 2.25 0 0 1 16.5 21h-6a2.25 2.25 0 0 1-2.25-2.25V15m-3 0-3-3m0 0 3-3m-3 3H15" />
                            </svg>
                          </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="p-4">
            <slot />
        </div>

    </main>

</div>
</BaseLayout>

<script>
    const currentPath = window.location.pathname;
    const links = document.querySelectorAll('.nav-link');
  
    links.forEach(link => {
      if (link.getAttribute('href') === currentPath) {
        link.classList.add('active');
        link.setAttribute('aria-expanded', 'true');
  
        const submenu = link.closest('.menu-item')?.querySelector('.submenu');
        if (submenu) {
          submenu.classList.remove('hidden');
        }
      }
    });
  </script>
